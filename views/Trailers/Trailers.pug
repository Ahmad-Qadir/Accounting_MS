include ../Components/Header
block content
    br
    .container-fluid
        // Page Heading
        .container
            != messages('message', locals)
            if errors
                each error, i in errors
                    div(class="note note-danger") #{error.msg}
        //- .d-sm-flex.align-items-left.justify-content-between.mb-4
        //-   h1.h3.mb-0.text-gray-800=title
        //-   .span
        //-     //- a.d-none.d-sm-inline-block.btn.btn-sm.btn-primary.shadow-sm.text-white.mr-2(id="backup" onclick="backupAll()")
        //-     //-   i.fas.fa-database.fa-sm.text-white-50
        //-     //-   |  Backup Hotspots
        //-     a.d-none.d-sm-inline-block.btn.btn-sm.btn-primary.shadow-sm.text-white(href="/Profiles/AddNew")
        //-       i.fas.fa-plus-square.fa-sm.text-white-50
        //-       |  زیادکردنی کڕیاری نوێ
        .row
            #accordionExample.accordion
                each item,i in trailers
                    .accordion-item
                        h2(id="heading"+i).accordion-header
                            .row
                                button.accordion-button(type='button' data-mdb-toggle='collapse' data-mdb-target='#collapse'+i aria-expanded='true' aria-controls='collapse'+i)
                                    .col-md-1="بارهەڵگری ژمارە: "+item['_id']['trailerNumber']
                                    .col-md-2="کۆی بەرهەم: "+item['count']
                                    .col-md-2="تێچووی بارهەڵگر: "+item['items'][0]['cost']
                                    .col-md-2="کۆی گشتی نرخ: "+item['amount']
                                    .col-md-3="بەروار: "+item['items'][0]['createdAt'].toLocaleString()
                                    .col-md-2 
                                        a.btn.btn-sm.btn-secondary.m-2( title="چاپکردنی تۆمار" style="padding: .25rem .4rem;font-size: .875rem;line-height: .5;border-radius: .2rem;" href="/Trailers/"+item['_id']['trailerNumber']+"/Invoices")
                                            span.icon.text-white-50
                                                i.fas.fa-print
                        .accordion-collapse.collapse.hide(aria-labelledby="heading"+i data-mdb-parent='#accordionExample' id="collapse"+i)
                            .accordion-body
                                .container-fluid.table-responsive
                                    table.table.table-hover.table-sm.dt-responsive.table-striped
                                        thead.thead-light
                                            tr(style="text-align:center; font-size:3 rem")
                                                th(scope='col') #
                                                th(scope='col') بڕاندی بەرهەم
                                                th(scope='col') ناوی بەرهەم
                                                th(scope='col') کۆمپانیای وەبەرهێن
                                                th(scope='col') پێوانەی تاک
                                                th(scope='col') جۆری بەرهەم
                                                th(scope='col') شوێنی بەکارهێنان
                                                th(scope='col') بڕی پێوانە
                                                th(scope='col') نرخی هاتوو
                                                th(scope='col') نرخی کۆمپانیا
                                                th(scope='col') نرخی جیاوازی
                                                th(scope='col') بڕی هاتوو
                                                th(scope='col') ڕەنگ
                                                th(scope='col') کۆی نرخ(بێ تێچوو)
                                                th(scope='col') کۆی گشتی
                                                th(scope='col') چالاکی


                                        tbody
                                            each product,j in item['data']
                                                each product,k in item['data']
                                                    if item['items'][j]['productID'].equals(product['_id'])
                                                        tr
                                                            -var index=j+1
                                                            tr(style="font-weight:bold; font-size:2 rem")
                                                                td(style="text-align:center;")=index
                                                                td(style="text-align:center;")=product['itemModel']
                                                                td(style="text-align:center;")=product['itemName']
                                                                td(style="text-align:center;")=product['manufacturerCompany']
                                                                td(style="text-align:center;")=product['itemUnit']
                                                                td(style="text-align:center;")=product['itemType']
                                                                td(style="text-align:center;")=product['usedIn']
                                                                td(style="text-align:center;")=product['weight']
                                                                td(style="text-align:center;")=item['items'][j]['camePrice']
                                                                td(style="text-align:center;")=item['items'][j]['sellPrice']
                                                                td(style="text-align:center;")=(item['items'][j]['sellPrice']-item['items'][j]['camePrice']).toFixed(2)
                                                                td(style="text-align:center;")=item['items'][j]['totalQuantity']
                                                                td(style="text-align:center;")=product['color']
                                                                td(style="text-align:center;")=(parseFloat(item['items'][j]['totalQuantity'])*parseFloat(item['items'][j]['camePrice'])).toFixed(2)
                                                                td(style="text-align:center;")=(parseFloat(item['items'][j]['totalQuantity'])*parseFloat(item['items'][j]['sellPrice'])).toFixed(2)
                                                                td(style="text-align:center;")
                                                                    a.btn.btn-sm.btn-warning.m-2( title="نوێکردنەوەی تۆمار" style="padding: .25rem .4rem;font-size: .875rem;line-height: .5;border-radius: .2rem;" href="/Trailers/Modification/"+item['_id']['trailerNumber']+"/"+item['items'][j]['_id'])
                                                                        span.icon.text-white-50
                                                                            i.fas.fa-pencil-alt
                                                                    a.btn.btn-sm.btn-danger.m-2( title="ڕەشکردنەوەی تۆمار" style="padding: .25rem .4rem;font-size: .875rem;line-height: .5;border-radius: .2rem;" href="/Trailers/Delete/"+item['_id']['trailerNumber']+"/"+item['items'][j]['_id'])
                                                                        span.icon.text-white-50
                                                                            i.fas.fa-trash
